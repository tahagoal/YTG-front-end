<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YTG</title>
    <link rel="canonical" href="https://ytg.eco" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content=""/>
    <meta property="og:description" content=""YTG Descriptions""
    />
    <meta property="og:url" content="https://ytg.eco" />
    <meta property="og:site_name" content="YTG Egypt" />
    <meta property="og:image" content=https://ytg.eco/assets/imgs/logo.png />
    <meta name="twitter:card" content="summary" />
    
    <link rel="shortcut icon" href="assets/imgs/favicon.ico" type="image/x-icon">
    <link rel="icon" href="assets/imgs/favicon.ico" type="image/x-icon">
    <meta name="twitter:title" content=""/>
    <meta name="twitter:image" content=https://ytg.eco/assets/imgs/logo.png />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130196602-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-130196602-1');
    </script>

    <script src="js/jquery.min.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Quicksand" rel="stylesheet">
    <link rel="stylesheet" href="css/aos.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/bootstrap-social.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://jqueryvalidation.org/files/demo/site-demos.css">
</head>

<body id="body">

    <nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light login_nav" id="ftco-navbar">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <span class="flaticon-gavel">
                    <img src="assets/imgs/logo.png"> </span>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav" aria-controls="ftco-nav" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="oi oi-menu"></span> Menu
            </button>

            <div class="collapse navbar-collapse" id="ftco-nav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a href="home.html" class="nav-link">Home</a>
                    </li>
                    <li class="nav-item">
                        <a href="about.html" class="nav-link">About</a>
                    </li>
                    <li class="nav-item">
                        <a href="newsevents.html" class="nav-link">News & Events</a>
                    </li>
                    <li class="nav-item active">
                        <a href="programs.html" class="nav-link">Programs & Services</a>
                    </li>
                    <li class="nav-item">
                        <a href="partners.html" class="nav-link">Partners</a>
                    </li>
                    <li class="nav-item">
                        <a href="careers.html" class="nav-link">Careers</a>
                    </li>

                    <li class="btn-li-nav login_navbar">
                        <a href="login.html" class="btn-nav login">Login</a>
                    </li>

                    <div class="dropdown">
                        <li class="btn-li-nav logout_navbar dropbtn">
                            <a href="javascript:void(0)" class="btn-nav"><img id="profile_image" src="assets/imgs/profile.jpeg" /></a>
                        </li>
                        <div class="dropdown-content">
                            <a href="profile.html">My Profile</a>
                            <a href="edit.html">Edit Profile</a>
                            <a href="" class="logout_button">Logout</a>
                        </div>
                    </div>

                </ul>
            </div>
        </div>
    </nav>

    <section class="ftco-section-2 first_section_careers">
        <div class="container-fluid">
            <div class="section-2-blocks-wrapper row no-gutters">
                <div class="col-md-1"></div>
                <div class="text col-md-4" style="margin-top: 100px;">
                    <h2 class="new_spacing job_title" style="color: white;">

                    </h2>
                </div>
            </div>
        </div>
    </section>

    <section class="ftco-section-2">
        <div class="container-fluid">
            <div class="section-2-blocks-wrapper row no-gutters">
                <form class="center" id="form_created" style="width:60%;">
                    <div class="dynamic_form">

                    </div>
                    <input type="submit" value="Submit" class="submit_form center btn btn-2 btn-2g">
                </form>

            </div>
    </section>

        <footer class="ftco-footer ftco-bg-dark ftco-section">
        <div class="container">
            <div class="row mt-5" style="padding-bottom: 60px;">
                <div class="col-md-3">
                    <div class="ftco-footer-widget mb-4">
                        <h2 class="ftco-heading-2">youthinkgreen Egypt</h2>
                        <ul class="list-unstyled mt-3">
                            <li>
                                <a class="py-2 d-block">Think Global, Act Local</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="ftco-footer-widget mb-4">
                        <!-- <h2 class="ftco-heading-2">Communities</h2> -->
                        <ul class="list-unstyled pages_list">
                            <li class="center">
                                <a href="about.html">About us</a> <span style="color: #d0cdc5;"> - </span>
                                <a href="news.html">News</a> <span style="color: #d0cdc5;"> - </span>
                                <a href="programs.html">Programs</a>
                            </li>
                            <li class="center">
                                <a href="partners.html">Partner</a> <span style="color: #d0cdc5;"> - </span>
                                <a href="careers.html">Careers</a><span style="color: #d0cdc5;"> - </span>
                                <a href="privacypolicy.html">Privacy Policy</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="ftco-footer-widget mb-4">
                        <ul class="list-unstyled mb-4" style="display: -webkit-inline-box;">
                            <li style="padding: 0px 15px;">
                                <a target="_blank" href="https://www.facebook.com/YouthinkgreenEgypt">
                                    <img src="assets/imgs/facebook.png">
                                </a>
                            </li>

                            <li style="padding: 0px 15px;">
                                <a target="_blank" href="https://www.linkedin.com/company/youthinkgreen---egypt/">
                                    <img alt="linked" src="assets/imgs/linked.png">
                                </a>
                            </li>

                            <li style="padding: 0px 15px;">
                                <a href="https://www.instagram.com/youthinkgreeneg/">
                                    <img src="assets/imgs/instagram.png">
                                </a>
                            </li>
                        </ul>
                        <div>
                            <button class="btn btn-2 btn-2g" id="open-popup">Subscribe</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    <div class="row extra_foot" style="background-color: #171717;">
            <div class="col-sm-12">
                <h4 style="text-align: center; color:white; font-size:14px;padding: 10px 0px 5px 0px;">created with <span>â™¥</span> at TALK, LLC</h4>
            </div>
        </div></footer>
</body>
<script src="js/bootstrap.min.js"></script>
<script src="js/aos.js" type="text/javascript"></script>
<script src="js/scripts_login.js" type="text/javascript"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/additional-methods.min.js"></script>

<script>
    var backend_url = 'https://ytg.eco/';
    var job_id;
    var questions_global;
    var userData;

    jQuery.validator.setDefaults({
      debug: true,
      success: "valid"
    });

    check_ath = function () {
        var token = localStorage.getItem('token');

        if (token != null) {
            $('.login_navbar').css('display', 'none');
            $('.logout_navbar').css('display', 'block');
        }

        else {
            $('.login_navbar').css('display', 'block');
            $('.logout_navbar').css('display', 'none');
        }
    }

    job_append = function(job){
        $('.job_title').append(job.title);
    }

    get_jobsingle = function () {
        var url = backend_url + 'api/';
        job_id = get_param('job_id');
        $.get(url + 'jobs/' + job_id , {headers: {"Authorization": localStorage.getItem('token')}},
            function (data) {
                job = data;
                job_append(job);
            });
    }

    get_user = function () {
        var user_id = localStorage.getItem('user_id');
        var options = {
            method: 'GET',
            url: backend_url + 'api/users/' + user_id + '/profile',
            headers: {"Authorization": localStorage.getItem('token')}
        };
        $.get(options,
            function (data) {
            userData = data;
                if (userData.image != null && userData.image != '') {
                    document.getElementById("profile_image").src = userData.image;
                    document.getElementById("profile_p").src = userData.image;
                }
                userData = data;
            });
    };

    $(document).ready(function ($) {
        get_job();
        check_ath();
        get_jobsingle();
        get_user();
    })

    function getBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });
    }

    var file_inp = [];

       $('.submit_form').click(function (e) {
        // e.preventDefault();
        if ($("#form_created").valid()) {
            var query_string = $('form :input').serialize();
            var params = query_string.split('&'),
            query_object = {};

            for(var i = 0; i < params.length; i++){
                var temp = params[i].split('='),
                    key = temp[0],
                    val = temp[1];

                query_object[key] = query_object[key] || [];
                query_object[key].push(val);
            }

            var post_request = [];
            var user_id = localStorage.getItem('user_id');

            for (var i = 0; i < questions_global.length; i++) {
                if (questions_global[i].type != 'File Upload') {
                    var answer = ''
                    if(query_object[questions_global[i]._id].length > 1){
                        for(var j=0; j< query_object[questions_global[i]._id].length; j++){
                            answer = answer + query_object[questions_global[i]._id][j] + ',';
                        }
                    }
                    else{
                        answer = query_object[questions_global[i]._id];
                    }
                    var object = {
                        'question': questions_global[i].question,
                        'answer': answer,
                        'user': user_id,
                        'type':questions_global[i].type        
                    }
                    post_request.push(object);
                }
                else {
                    var file = $('#form_created input[name=' + questions_global[i]._id + ']')[0].files[0];

                    getBase64(file).then(function (base_data) {
                        file_inp.push(base_data);
                    });

                }
            }

            var url = backend_url + 'api/jobs/' + job_id + '/questions';
            var data = {
                'questions': post_request
            }

            setTimeout(function () {
                var j = 0;
                for (var i = 0; i < questions_global.length; i++){
                    if (questions_global[i].type == 'File Upload') {
                        var object = {
                                'question': questions_global[i].question,
                                'answer': file_inp[j],
                                'user': user_id,
                                'type':questions_global[i].type
                            }
                        post_request.push(object);
                        j++;
                    }
                }
            
                var options = {
                    method: 'POST',
                    data: data,
                    url: url, 
                    headers: {"Authorization": localStorage.getItem('token')},
                };
            
                var submit_before = false;

                for(var i = 0; i < userData.jobs.length ; i++){
                    if(userData.jobs[i].job._id == job_id){
                        submit_before = true;
                    }
                }

                if(submit_before){
                    swal("Submitted before", "Are you sure that you want to override this job data?", "success", {
                        buttons: {cancel: "Cancel", ok:"Do it!"},
                    }).then((value) => {
                      switch (value) {
                     
                        case "cancel":
                          break;
                     
                        case "ok":
                          $.post(options, function (result) {
                            swal("", "Thank you for your submission", "success", {
                                    button: "Ok!",
                                }).then((value) => {
                                    window.location.replace('profile.html');
                                });
                            })
                            .done(function () {
                                console.log("second success");
                            })
                            .fail(function (error) {
                                swal(error.responseJSON.message, "", "error", {
                                    button: "Try again!",
                                });
                            })
                            .always(function () {
                                console.log("finished");
                            });
                          break;
                      }
                    })
                }

                else{
                    $.post(options, function (result) {
                        swal("", "Thank you for your submission", "success", {
                                button: "Ok!",
                            }).then((value) => {
                                window.location.replace('profile.html');
                            });
                        })
                        .done(function () {
                            console.log("second success");
                        })
                        .fail(function (error) {
                            swal(error.responseJSON.message, "", "error", {
                                button: "Try again!",
                            });
                        })
                        .always(function () {
                            console.log("finished");
                        });
                }
            }, 2000);
        }

    })

    get_job = function () {
        var url = backend_url;
        job_id = get_param('job_id');

        $.ajax({
            url: url + 'api/jobs/' + job_id + '/questions',
            success: function(data) {
                questions = data;
                questions_global = questions;
                for (var i = 0; i < questions.length; i++) {
                    $('.dynamic_form').append('<div id="' + questions[i]._id + '" class="row mt-4 mb-5"></div>')
                }
                append_form(questions);
            },
            error: function(XMLHttpRequest, textStatus, errorThrown) {
               console.log(textStatus);
            },

            beforeSend: function (xhr) {
              xhr.setRequestHeader ("Authorization", localStorage.getItem('token'));
            },
            type: 'GET',
            contentType: 'json',
        });
    }

    append_form = function (questions) {
        for (var i = 0; i < questions.length; i++) {
            if (questions[i].type == 'Checkbox') {
                $('#' + questions[i]._id).append('<h3>' + questions[i].question + '</h3>');
                for (var j = 0; j < questions[i].answers.length; j++) {
                    $('#' + questions[i]._id).append('<div class="col-sm-1"></div><div class="form-group col-sm-5">' +
                        '<input type="checkbox" required class="form-check-input checkbox__flag" value="' + questions[i].answers[j] + '" name="' + questions[i]._id + '" id ="q' + questions[i]._id + j + '">' +
                        '<label for="q' + questions[i]._id + j + '" class="form-check-label checkbox__trigger"><svg class="checkbox" viewBox="0 0 24 24"><rect class="checkbox__rect" x="3" y="3" rx="3" ry="3" width="20" height="20"></rect><polyline class="checkbox__line" points="9 11 12 14 23 3"></polyline></svg><span class="checkbox__caption">' + questions[i].answers[j] + '</span></label>');
                }
            }

            else if (questions[i].type == 'RadioButton') {
                $('#' + questions[i]._id).append('<h3>' + questions[i].question + '</h3>');
                for (var j = 0; j < questions[i].answers.length; j++) {
                    $('#' + questions[i]._id).append('<div class="col-sm-1"></div><div class="form-group radio col-sm-5">' +
                        '<input type="radio" required class="form-check-input" value="' + questions[i].answers[j] + '" name="' + questions[i]._id + '" id ="q' + questions[i]._id + j + '">' +
                        '<label for="q' + questions[i]._id + j + '" class="form-check-label radio-label">' + questions[i].answers[j] + '</label>');
                }
            }

            else if (questions[i].type == 'Paragraph') {
                $('#' + questions[i]._id).append('<h3>' + questions[i].question + '</h3>');
                $('#' + questions[i]._id).append('<div class="col-sm-1"></div><textarea required class="form-control" style="width:70%;" name="' + questions[i]._id +
                    '"rows="5" cols="30"></textarea>');
            }

            else if (questions[i].type == 'Short Answer') {
                $('#' + questions[i]._id).append('<h3>' + questions[i].question + '</h3>');
                $('#' + questions[i]._id).append('<div class="col-sm-1"></div><div class="form-group" style="width:70%;">' +
                    '<input type="text" required class="form-control" name="' + questions[i]._id + '">' +
                    '<label class="form-check-label"></label>');
            }

            else if (questions[i].type == 'Dropdown Menu') {
                var question_html = ''
                question_html += ('<h3>' + questions[i].question + '</h3>');
                for (var j = 0; j < questions[i].answers.length; j++) {
                    if (j == 0) {
                        question_html += ('<div class="col-sm-1"></div><select required name="' + questions[i]._id + '" class="custom-select">');
                    }
                else if (j - 1 == questions[i].answers.length) {
                        question_html += ('</select>');
                    }
                    question_html += (
                        '<option value="' + j + '">' + questions[i].answers[j] + '</option>');
                }
                $('#' + questions[i]._id).append(question_html);
            }

            else if (questions[i].type == 'File Upload') {
                var question_html = ''
                question_html += ('<h3>' + questions[i].question + '</h3>');

                question_html += ('<div class="col-sm-1"></div><div class="form-group" style="width:70%">');
                question_html += ('<label for="exampleFormControlFile1"></label>');
                question_html += ('<input required type="file" name="' + questions[i]._id + '" class="form-control-file" id="exampleFormControlFile1"> </div>');

                $('#' + questions[i]._id).append(question_html);
            }

        }
    }

    get_param = function (param) {
        var sPageURL = window.location.search.substring(1);
        var sURLVariables = sPageURL.split('&');
        for (var i = 0; i < sURLVariables.length; i++) {
            var sParameterName = sURLVariables[i].split('=');
            if (sParameterName[0] == param) {
                return sParameterName[1];
            }
        }
    }

</script>



<script type="text/javascript">
    open_mail = function(){
        // window.dojoRequire(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us19.list-manage.com","uuid":"cb651c1984ff21237aea0f68d","lid":"655f98310e","uniqueMethods":true}) })
        window.location.href = 'https://eco.us19.list-manage.com/subscribe?u=cb651c1984ff21237aea0f68d&id=655f98310e';
    }

    $('#open-popup').click(function(){
        open_mail();
    })
</script>


</html>